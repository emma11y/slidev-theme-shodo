const __vite__fileDeps=["assets/slidev/CodeRunner-B723jmqI.js","assets/modules/unplugin-icons-yvtIbPUE.js","assets/modules/vue-BHIC3QRz.js","assets/monaco/bundled-types-BSQQkv1f.js","assets/modules/file-saver-igGfcqei.js","assets/monaco/bundled-types-Cjcdkwd9.css","assets/index-ByDRFW8y.js","assets/modules/shiki-CfCxQgMn.js","assets/modules/shiki-BPvBenZD.css","assets/index-CzxNJzI-.css","assets/slidev/IconButton.vue_vue_type_script_setup_true_lang-CgFbssxI.js","assets/CodeRunner-YBfxSSx9.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as h,l as P}from"../monaco/bundled-types-BSQQkv1f.js";import{d as T,t as l,y as M,aD as I,ae as F,n as v,o as O,b as K,e as E,h as U,c as J,H as S,g as Y,ay as q}from"../modules/vue-BHIC3QRz.js";import{l as B}from"../lz-string-7V7f_eN4.js";import{J as G,a as Q,a8 as L}from"../index-ByDRFW8y.js";const X={class:"relative slidev-monaco-container"},ie=T({__name:"Monaco",props:{codeLz:{default:""},diffLz:{},lang:{default:"typescript"},readonly:{type:Boolean,default:!1},lineNumbers:{default:"off"},height:{default:"initial"},editorOptions:{},ata:{type:Boolean,default:!0},runnable:{type:Boolean,default:!1},writable:{},autorun:{type:[Boolean,String],default:!0},showOutputAt:{type:[null,Boolean,String,Number,Array]},outputHeight:{},highlightOutput:{type:Boolean,default:!0},runnerOptions:{}},setup(x){const e=x,V=q(()=>h(()=>import("./CodeRunner-B723jmqI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(r=>r.default)),s=l(B.decompressFromBase64(e.codeLz).trimEnd()),y=e.diffLz&&l(B.decompressFromBase64(e.diffLz).trimEnd()),D=M(()=>e.writable&&!e.readonly&&!1),p={ts:"typescript",js:"javascript"}[e.lang]??e.lang,C={typescript:"mts",javascript:"mjs",ts:"mts",js:"mjs"}[e.lang]??e.lang,N=l(),f=l(),g=l(0),i=l(),k=M(()=>e.height==="auto"?`${g.value}px`:e.height==="initial"?`${i.value}px`:e.height),_=l(),{$page:A,$renderContext:$}=G(),{currentSlideNo:H}=Q(),R=I(()=>Math.abs(A.value-H.value)<=1&&_.value,r=>{["slide","presenter"].includes($.value)?r():setTimeout(r,5e3)});return F(async()=>{const{default:r}=await h(async()=>{const{default:t}=await import("../monaco/bundled-types-BSQQkv1f.js").then(a=>a.x);return{default:t}},__vite__mapDeps([3,2,4,5])),{ata:d,monaco:o,editorOptions:W}=await r(),u=o.editor.createModel(s.value,p,o.Uri.parse(`file:///${L()}.${C}`));u.onDidChangeContent(()=>s.value=u.getValue());const b={automaticLayout:!0,readOnly:e.readonly,lineNumbers:e.lineNumbers,minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:10,bottom:10},lineNumbersMinChars:3,bracketPairColorization:{enabled:!1},tabSize:2,fontSize:11.5,fontFamily:"var(--slidev-code-font-family)",scrollBeyondLastLine:!1,...W,...e.editorOptions};let n;if(y){const t=o.editor.createModel(y.value,p,o.Uri.parse(`file:///${L()}.${C}`));t.onDidChangeContent(()=>s.value=u.getValue());const a=o.editor.createDiffEditor(f.value,{renderOverviewRuler:!1,...b});a.setModel({original:u,modified:t});const c=a.getOriginalEditor(),m=a.getModifiedEditor(),w=()=>{const z=Math.max(c.getContentHeight(),m.getContentHeight())+4;i.value??(i.value=z),g.value=z,v(()=>a.layout())};c.onDidContentSizeChange(w),m.onDidContentSizeChange(w),n=m}else{const t=o.editor.create(f.value,{model:u,lineDecorationsWidth:0,...b});t.onDidContentSizeChange(a=>{const c=a.contentHeight+4;i.value??(i.value=c),g.value=c,v(()=>n.layout())}),n=t}_.value=()=>{R(),h(()=>import("../monaco/bundled-types-BSQQkv1f.js").then(t=>t.y),__vite__mapDeps([3,2,4,5])),e.ata&&(d(n.getValue()),n.onDidChangeModelContent(P(1e3,()=>{d(n.getValue())})))};const j=n.layoutContentWidget.bind(n);n.layoutContentWidget=t=>{j(t),t.getId()==="editor.contrib.resizableContentHoverWidget"&&(t._resizableNode.domNode.style.transform=t._positionPreference===1?"translateY(calc(100% * (var(--slidev-slide-scale) - 1)))":"")},n.addAction({id:"slidev-save",label:"Save",keybindings:[o.KeyMod.CtrlCmd|o.KeyCode.KeyS],run:()=>{D.value,console.warn("[Slidev] this monaco editor is not writable, save action is ignored.")}}),v(()=>o.editor.remeasureFonts())}),(r,d)=>(O(),K("div",X,[E("div",{ref_key:"outer",ref:N,class:"relative slidev-monaco-container-inner",style:U({height:k.value})},[E("div",{ref_key:"container",ref:f,class:"absolute inset-0.5"},null,512)],4),e.runnable?(O(),J(S(V),{key:0,modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=o=>s.value=o),lang:S(p),autorun:e.autorun,"show-output-at":e.showOutputAt,height:e.outputHeight,"highlight-output":e.highlightOutput,"runner-options":e.runnerOptions},null,8,["modelValue","lang","autorun","show-output-at","height","highlight-output","runner-options"])):Y("v-if",!0)]))}});export{ie as _};
